<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Django Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: Segoe UI, Arial, sans-serif; margin: 2rem; }
    form, table { max-width: 640px; }
    label { display: block; margin-top: .75rem; font-weight: 600; }
    input, select, button { padding: .5rem; font-size: 1rem; }
    .errors { background: #ffecec; border: 1px solid #f5c2c2; color: #b30000; padding: .75rem; margin-bottom: 1rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 1.5rem; }
    th, td { border: 1px solid #ddd; padding: .5rem .6rem; text-align: left; }
    tr.highlight { background: #fff8d6; }
    .muted { color: #666; font-size: .9rem; }
  </style>
</head>
<body>
  <h1>Calculator</h1>

  {% if form.non_field_errors %}
  <div class="errors">
    {% for err in form.non_field_errors %}<div>{{ err }}</div>{% endfor %}
  </div>
  {% endif %}

  <form method="post" action="">
    {% csrf_token %}

    <label for="{{ form.number1.id_for_label }}">Number 1</label>
    {{ form.number1 }}

    <label for="{{ form.number2.id_for_label }}">Number 2</label>
    {{ form.number2 }}

    <label for="{{ form.number3.id_for_label }}">Number 3</label>
    {{ form.number3 }}

    <label for="{{ form.operator.id_for_label }}">Operator</label>
    {{ form.operator }}

    <div style="margin-top: 1rem;">
      <button type="submit">Compute & Save</button>
    </div>

    {% if form.errors %}
      <div class="errors" style="margin-top: 1rem;">
        <strong>Please fix the following:</strong>
        <ul>
          {% for field, errs in form.errors.items %}
            {% for err in errs %}<li>{{ field }}: {{ err }}</li>{% endfor %}
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  </form>

  <h2>Recent calculations</h2>
  <p class="muted">Click a row to refill the form with those values.</p>

  <table>
    <thead>
      <tr>
        <th>When</th>
        <th>Expression</th>
        <th>Result</th>
      </tr>
    </thead>
    <tbody>
      {% for c in recent %}
        <tr class="{% if selected and selected.id == c.id %}highlight{% endif %}">
          <td><a href="?id={{ c.id }}">{{ c.created_at|date:"Y-m-d H:i:s" }}</a></td>
          <td>{{ c.number1 }} {{ c.operator }} {{ c.number2 }} {{ c.operator }} {{ c.number3 }}</td>
          <td>{{ c.result }}</td>
        </tr>
      {% empty %}
        <tr><td colspan="3">No calculations yet. Submit the form above to save one.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</body>
</html>
